<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  
    
      
    

    
  

  

  
    
      
    

    
  

  
    
      
    

    
  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Lobster Two:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />





  <link rel="alternate" href="/atom.xml" title="Ceylog Blog" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="CAS 服务器端配置文件">
<meta name="keywords">
<meta property="og:type" content="article">
<meta property="og:title" content="CAS 服务器端配置文件">
<meta property="og:url" content="http://blog.wglgg.cn/2014/07/08/cas-server-config/index.html">
<meta property="og:site_name" content="Ceylog Blog">
<meta property="og:description" content="CAS 服务器端配置文件">
<meta property="og:image" content="http://blog.wglgg.cn/images/cas/cas_clip_image006.jpg">
<meta property="og:updated_time" content="2017-04-07T06:51:33.593Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="CAS 服务器端配置文件">
<meta name="twitter:description" content="CAS 服务器端配置文件">
<meta name="twitter:image" content="http://blog.wglgg.cn/images/cas/cas_clip_image006.jpg">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://blog.wglgg.cn/2014/07/08/cas-server-config/"/>





  <title> CAS 服务器端配置文件 | Ceylog Blog </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?71481116ee0fd744a092e4317c9f870f";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>










  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Ceylog Blog</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
    
      <p class="site-subtitle">Whatever is worth doing is worth doing well.</p>
    
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup">
 <span class="search-icon fa fa-search"></span>
 <input type="text" id="local-search-input">
 <div id="local-search-result"></div>
 <span class="popup-btn-close">close</span>
</div>


    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://blog.wglgg.cn/2014/07/08/cas-server-config/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="ceylog">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Ceylog Blog">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Ceylog Blog" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                CAS 服务器端配置文件
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2014-07-08T00:00:00+08:00">
                2014-07-08
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/blog/" itemprop="url" rel="index">
                    <span itemprop="name">blog</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2014/07/08/cas-server-config/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2014/07/08/cas-server-config/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          
              <div class="post-description">
                  CAS 服务器端配置文件
              </div>
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>CAS 服务器端主要配置文件如下：</p>
<ul>
<li>login-webflow.xml：其中内容指定了当访问cas/login时的程序流程，初始“initialFlowSetup”</li>
<li>cas-servlet.xml：servlet与class对应关系</li>
<li>deployerConfigContext.xml：认证管理器相关</li>
<li>cas.properties：系统属性设置</li>
<li>applicationContext.xml：系统属性相关</li>
<li>argumentExtractorsConfiguration.xml：不是很了解它的用途</li>
<li>ticketExpirationPolicies.xml：ticket过期时间设置</li>
<li>ticketGrantingTicketCookieGenerator.xml：TGT cookie属性相关，是否支持http也在这儿修改</li>
<li>ticketRegistry.xml：保存ticket的类相关设置</li>
<li>uniqueIdGenerators.xml：ticket自动生成类设置</li>
<li>warnCookieGenerator.xml：同ticketGrantingTicketCookieGenerator.xml，生成的 cookie名为CASPRIVACY</li>
</ul>
<h2 id="login-："><a href="#login-：" class="headerlink" title="/login ："></a>/login ：</h2><p>当访问/login时，会调用login-webflow.xml中的流程图：<br><img src="/images/cas/cas_clip_image006.jpg" alt="cas flow">    </p>
<p>##/serviceValidate:<br>对应的处理类是org.jasig.cas.web.ServiceValidateController，主要负责对service ticket的验证，失败返回casServiceValidationFailure.jsp，成功返回casServiceValidationSuccess.jsp对service ticket的验证是通过client端向server端发送http（或https）实现的逻辑： </p>
<ol>
<li>通过由client端传来的ticket到DefaultTicketRegistry中获取缓存的ServiceTicketImpl对象，并判断其是否已经过期（ST过期时间默认是5分钟，TGT默认是2个小时，可以在ticketExpirationPolicies.xml中进行修改）以及与当前service的id是否相一，以上都满足则表示验证通过。</li>
<li>通过ServiceTicketImpl对象获取到登录之后的Authentication对象，借助于它生成ImmutableAssertionImpl对象并返回</li>
<li>成功返回</li>
</ol>
<h2 id="CAS数据流程"><a href="#CAS数据流程" class="headerlink" title="CAS数据流程"></a>CAS数据流程</h2><p>Credentials–&gt;Principal–&gt;Authentication </p>
<h2 id="定义自己的AuthenticationHandler"><a href="#定义自己的AuthenticationHandler" class="headerlink" title="定义自己的AuthenticationHandler"></a>定义自己的AuthenticationHandler</h2><p>在中心认证进行认证的过程中会调用deployerConfigContext.xml中设置的AuthenticationHandler来进行认证工作。 </p>
<pre><code>&lt;property name=&quot;authenticationHandlers&quot;&gt;   
    &lt;list&gt;   
        &lt;!--  
            This is the authentication handler that authenticates services by means of callback via SSL, thereby validating a server side SSL certificate.   
        --&gt;   
        &lt;bean class=&quot;org.jasig.cas.authentication.handler.support.HttpBasedServiceCredentialsAuthenticationHandler&quot;  
            p:httpClient-ref=&quot;httpClient&quot; /&gt;   
        &lt;!--   
             This is the authentication handler declaration that every CAS deployer will need to change before deploying CAS    
             into production.  The default SimpleTestUsernamePasswordAuthenticationHandler authenticates UsernamePasswordCredentials   
             where the username equals the password.  You will need to replace this with an AuthenticationHandler that implements your   
             local authentication strategy.  You might accomplish this by coding a new such handler and declaring   
             edu.someschool.its.cas.MySpecialHandler here, or you might use one of the handlers provided in the adaptors modules.   
            --&gt;   
        &lt;bean   
            class=&quot;org.jasig.cas.authentication.handler.support.SimpleTestUsernamePasswordAuthenticationHandler&quot; /&gt;   
        &lt;bean class=&quot;com.goldarmor.live800.cas.Live800CasAuthenticationHandler&quot;&gt;   
            &lt;property name=&quot;dataSource&quot; ref=&quot;casDataSource&quot; /&gt;   
        &lt;/bean&gt;   
    &lt;/list   
&lt;/property&gt; 
&lt;property name=&quot;authenticationHandlers&quot;&gt; 
    &lt;list&gt; 
        &lt;!--
        This is the authentication handler that authenticates services by means of callback via SSL, thereby validating
        a server side SSL certificate. 
        --&gt; 
        &lt;bean class=&quot;org.jasig.cas.authentication.handler.support.HttpBasedServiceCredentialsAuthenticationHandler&quot; 
        p:httpClient-ref=&quot;httpClient&quot; /&gt; 
        &lt;!-- 
        This is the authentication handler declaration that every CAS deployer will need to change before deploying CAS 
        into production.  The default SimpleTestUsernamePasswordAuthenticationHandler authenticates UsernamePasswordCredentials 
        where the username equals the password.  You will need to replace this with an AuthenticationHandler that implements your 
        local authentication strategy.  You might accomplish this by coding a new such handler and declaring
        edu.someschool.its.cas.MySpecialHandler here, or you might use one of the handlers provided in the adaptors modules. 
        --&gt; 
        &lt;bean 
        class=&quot;org.jasig.cas.authentication.handler.support.SimpleTestUsernamePasswordAuthenticationHandler&quot; /&gt; 
        &lt;bean class=&quot;com.goldarmor.live800.cas.Live800CasAuthenticationHandler&quot;&gt; 
        &lt;property name=&quot;dataSource&quot; ref=&quot;casDataSource&quot; /&gt; 
        &lt;/bean&gt; 
    &lt;/list&gt; 
&lt;/property&gt; 
</code></pre><p>如上，我们定义了3个AuthenticationHandler，这正是CAS的一个，通过配置，我们可以实现针对不同的应用提供不同的认证方式，这样可以实现任意的中心认证。再来看看AuthenticationHandler的代码</p>
<pre><code>/**  
* Method to determine if the credentials supplied are valid.  
*   
* @param credentials The credentials to validate.  
* @return true if valid, return false otherwise.  
* @throws AuthenticationException An AuthenticationException can contain  
* details about why a particular authentication request failed.  
*/  

boolean authenticate(Credentials credentials)   
    throws AuthenticationException;   

/**  
* Method to check if the handler knows how to handle the credentials  
* provided. It may be a simple check of the Credentials class or something  
* more complicated such as scanning the information contained in the  
* Credentials object.  
*   
* @param credentials The credentials to check.  
* @return true if the handler supports the Credentials, false othewrise.  
*/  
boolean supports(Credentials credentials); 
/** 
 * Method to determine if the credentials supplied are valid. 
 * 
 * @param credentials The credentials to validate. 
 * @return true if valid, return false otherwise. 
 * @throws AuthenticationException An AuthenticationException can contain 
 * details about why a particular authentication request failed. 
 */
boolean authenticate(Credentials credentials) 
    throws AuthenticationException;
/** 
 * Method to check if the handler knows how to handle the credentials 
 * provided. It may be a simple check of the Credentials class or something 
 * more complicated such as scanning the information contained in the 
 * Credentials object. 
 * 
 * @param credentials The credentials to check. 
 * @return true if the handler supports the Credentials, false othewrise. 
 */ 
boolean supports(Credentials credentials); 
</code></pre><p>我们要做的就是实现这俩个方法而已，特别提醒：可以在cas-servlet.xml中设置你所使用的Credentials，如下：（其中的p:formObjectClass值，如果不指定默认使用UsernamePasswordCredentials）</p>
<pre><code>&lt;bean id=&quot;authenticationViaFormAction&quot; class=&quot;org.jasig.cas.web.flow.AuthenticationViaFormAction&quot;  
    p:formObjectClass=&quot;com.goldarmor.live800.cas.Live800CasCredentials&quot;  
    p:centralAuthenticationService-ref=&quot;centralAuthenticationService&quot;  
    p:warnCookieGenerator-ref=&quot;warnCookieGenerator&quot; /&gt; 
&lt;bean id=&quot;authenticationViaFormAction&quot; class=&quot;org.jasig.cas.web.flow.AuthenticationViaFormAction&quot; 
    p:formObjectClass=&quot;com.goldarmor.live800.cas.Live800CasCredentials&quot; 
    p:centralAuthenticationService-ref=&quot;centralAuthenticationService&quot; 
    p:warnCookieGenerator-ref=&quot;warnCookieGenerator&quot; /&gt;
</code></pre><h2 id="定义自己的credentialsToPrincipalResolvers"><a href="#定义自己的credentialsToPrincipalResolvers" class="headerlink" title="定义自己的credentialsToPrincipalResolvers"></a>定义自己的credentialsToPrincipalResolvers</h2><p>通过AuthenticationHandler的认证后，会调用在deployerConfigContext.xml中配置的credentialsToPrincipalResolvers来处理Credentials，生成Principal对象：</p>
<pre><code>&lt;property name=&quot;credentialsToPrincipalResolvers&quot;&gt;   
    &lt;list&gt;   
        &lt;!--   
            UsernamePasswordCredentialsToPrincipalResolver supports the UsernamePasswordCredentials that we use for /login    
            by default and produces SimplePrincipal instances conveying the username from the credentials.   
            If you&apos;ve changed your LoginFormAction to use credentials other than UsernamePasswordCredentials then you will also   
            need to change this bean declaration (or add additional declarations) to declare a CredentialsToPrincipalResolver that supports the   
            Credentials you are using.   
        --&gt;              
        &lt;bean   
            class=&quot;org.jasig.cas.authentication.principal.UsernamePasswordCredentialsToPrincipalResolver&quot; /&gt;   
        &lt;!--   
            HttpBasedServiceCredentialsToPrincipalResolver supports HttpBasedCredentials.  It supports the CAS 2.0 approach of   
            authenticating services by SSL callback, extracting the callback URL from the Credentials and representing it as a   
            SimpleService identified by that callback URL.   
            If you are representing services by something more or other than an HTTPS URL whereat they are able to   
            receive a proxy callback, you will need to change this bean declaration (or add additional declarations).   
            --&gt;   
        &lt;bean   
            class=&quot;org.jasig.cas.authentication.principal.HttpBasedServiceCredentialsToPrincipalResolver&quot; /&gt;   
        &lt;bean class=&quot;com.goldarmor.live800.cas.Live800CasCredentialsToPrincipalResolver&quot;/&gt;   
    &lt;/list&gt;   
&lt;/property&gt; 
&lt;property name=&quot;credentialsToPrincipalResolvers&quot;&gt; 
    &lt;list&gt; 
        &lt;!-- 
        UsernamePasswordCredentialsToPrincipalResolver supports the UsernamePasswordCredentials that we use for /login 
        by default and produces SimplePrincipal instances conveying the username from the credentials. 
        If you&apos;ve changed your LoginFormAction to use credentials other than UsernamePasswordCredentials then you will also 
        need to change this bean declaration (or add additional declarations) to declare a CredentialsToPrincipalResolver that supports the 
        Credentials you are using. 
        --&gt; 
        &lt;bean class=&quot;org.jasig.cas.authentication.principal.UsernamePasswordCredentialsToPrincipalResolver&quot; /&gt; 
        &lt;!-- 
        HttpBasedServiceCredentialsToPrincipalResolver supports HttpBasedCredentials.  It supports the CAS 2.0 approach of 
        authenticating services by SSL callback, extracting the callback URL from the Credentials and representing it as a 
        SimpleService identified by that callback URL. 
        If you are representing services by something more or other than an HTTPS URL whereat they are able to 
        receive a proxy callback, you will need to change this bean declaration (or add additional declarations). 
        --&gt; 
        &lt;bean class=&quot;org.jasig.cas.authentication.principal.HttpBasedServiceCredentialsToPrincipalResolver&quot; /&gt; 
        &lt;bean class=&quot;com.goldarmor.live800.cas.Live800CasCredentialsToPrincipalResolver&quot;/&gt; 
    &lt;/list&gt; 
&lt;/property&gt; 
</code></pre><p>如上：我们也可以像定义AuthenticationHandler一样，可以定义多个credentialsToPrincipalResolvers来处理Credentials，返回你所需要的Principal对象，下面来看看credentialsToPrincipalResolvers的方法：</p>
<pre><code>/**  
* Turn Credentials into a Principal object by analyzing the information  
* provided in the Credentials and constructing a Principal object based on  
* that information or information derived from the Credentials object.  
*   
* @param credentials from which to resolve Principal  
* @return resolved Principal, or null if the principal could not be resolved.  
*/  
Principal resolvePrincipal(Credentials credentials);   

/**  
* Determine if a credentials type is supported by this resolver. This is  
* checked before calling resolve principal.  
*   
* @param credentials The credentials to check if we support.  
* @return true if we support these credentials, false otherwise.  
*/  


boolean supports(Credentials credentials); 
/** 
 * Turn Credentials into a Principal object by analyzing the information 
 * provided in the Credentials and constructing a Principal object based on 
 * that information or information derived from the Credentials object. 
 * 
 * @param credentials from which to resolve Principal 
 * @return resolved Principal, or null if the principal could not be resolved. 
 */ 
Principal resolvePrincipal(Credentials credentials);
/** 
 * Determine if a credentials type is supported by this resolver. This is 
 * checked before calling resolve principal. 
 * 
 * @param credentials The credentials to check if we support. 
 * @return true if we support these credentials, false otherwise. 
 */

boolean supports(Credentials credentials);  
</code></pre><p>在CAS验证的时候，通过访问/serviceValidate可知：验证成功之后返回的casServiceValidationSuccess.jsp中的数据来源于Assertion，下面来看看它的代码：</p>
<pre><code>List&lt;Authentication&gt; getChainedAuthentications();   

/**  
* True if the validated ticket was granted in the same transaction as that  
* in which its grantor GrantingTicket was originally issued.  
*   
* @return true if validated ticket was granted simultaneous with its  
* grantor&apos;s issuance  
*/  

boolean isFromNewLogin();   


/**  
* Method to obtain the service for which we are asserting this ticket is  
* valid for.  
*   
* @return the service for which we are asserting this ticket is valid for.  
*/  

Service getService(); 
List&lt;Authentication&gt; getChainedAuthentications();
/** 
 * True if the validated ticket was granted in the same transaction as that 
 * in which its grantor GrantingTicket was originally issued. 
 * 
 * @return true if validated ticket was granted simultaneous with its 
 * grantor&apos;s issuance 
 */
boolean isFromNewLogin();

/** 
 * Method to obtain the service for which we are asserting this ticket is 
 * valid for. 
 * 
 * @return the service for which we are asserting this ticket is valid for. 
 */
Service getService(); 
</code></pre><p>通过getChainedAuthentications()方法，我们可以得到Authentication对象列表，再看看Authentication的代码：</p>
<pre><code>/**  
* Method to obtain the Principal.  
*   
* @return a Principal implementation  
*/  

Principal getPrincipal();   

/**  
* Method to retrieve the timestamp of when this Authentication object was  
* created.  
*   
* @return the date/time the authentication occurred.  
*/  

Date getAuthenticatedDate();   

/**  
* Attributes of the authentication (not the Principal).  
* @return the map of attributes.  
*/  
Map&lt;String, Object&gt; getAttributes(); 
/** 
 * Method to obtain the Principal. 
 * 
 * @return a Principal implementation 
 */
Principal getPrincipal();
/** 
 * Method to retrieve the timestamp of when this Authentication object was 
 * created. 
 * 
 * @return the date/time the authentication occurred. 
 */
Date getAuthenticatedDate();
/** 
 * Attributes of the authentication (not the Principal). 
 * @return the map of attributes. 
 */ 
Map&lt;String, Object&gt; getAttributes(); 
</code></pre><p>而这其中的Principal就来源于上面提到的由credentialsToPrincipalResolvers处理得到的Principal对象，最后看一下Principal的代码，我们只要再做一个实现他的代码，整个CAS Server就可以信手拈来了，呵呵</p>
<pre><code>/**  
* Returns the unique id for the Principal  
* @return the unique id for the Principal.  
*/  

String getId();   


/**  
 *   
 * @return  
 */  

Map&lt;String, Object&gt; getAttributes(); 
/** 
 * Returns the unique id for the Principal 
 * @return the unique id for the Principal. 
 */
String getId();

 /** 
 * 
 * @return 
 */
Map&lt;String, Object&gt; getAttributes();
</code></pre><p>我们还可以自定义自己的casServiceValidationSuccess.jsp和casLoginView.jsp页面等，具体的操作办法也是最简单的办法就是备份以前的页面之后修改成自己需要的页面。 </p>

      
    </div>

    <div>
      
        
<div id="wechat_subscriber" style="display: block; padding: 10px 0; margin: 20px auto; width: 100%; text-align: center">
    <img id="wechat_subscriber_qcode" src="/images/wechat_mp.jpg" alt="ceylog wechat" style="width: 200px; max-width: 100%;"/>
    <div>欢迎您扫一扫上面的微信公众号，订阅我公众平台！</div>
</div>


      
    </div>

    <div>
      
        
  <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
    <div>坚持原创技术分享，您的支持将鼓励我继续创作！</div>
    <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
      <span>赏</span>
    </button>
    <div id="QR" style="display: none;">
      
        <div id="wechat" style="display: inline-block">
          <img id="wechat_qr" src="/images/wx_pay.png" alt="ceylog WeChat Pay"/>
          <p>微信打赏</p>
        </div>
      
      
    </div>
  </div>


      
    </div>


    <footer class="post-footer">
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2014/07/10/cas-login-flow-httpwatch/" rel="next" title="CAS 登录流程httpwatch解析">
                <i class="fa fa-chevron-left"></i> CAS 登录流程httpwatch解析
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2014/07/06/cas-PGTIOU/" rel="prev" title="CAS-PGTIOU">
                CAS-PGTIOU <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
        <div class="ds-share flat" data-thread-key="2014/07/08/cas-server-config/"
     data-title="CAS 服务器端配置文件"
     data-content=""
     data-url="http://blog.wglgg.cn/2014/07/08/cas-server-config/">
  <div class="ds-share-inline">
    <ul  class="ds-share-icons-16">

      <li data-toggle="ds-share-icons-more"><a class="ds-more" href="javascript:void(0);">分享到：</a></li>
      <li><a class="ds-weibo" href="javascript:void(0);" data-service="weibo">微博</a></li>
      <li><a class="ds-qzone" href="javascript:void(0);" data-service="qzone">QQ空间</a></li>
      <li><a class="ds-qqt" href="javascript:void(0);" data-service="qqt">腾讯微博</a></li>
      <li><a class="ds-wechat" href="javascript:void(0);" data-service="wechat">微信</a></li>

    </ul>
    <div class="ds-share-icons-more">
    </div>
  </div>
</div>
      
    </div>
  </div>

          
          </div>
          

  <p>热评文章</p>
  <div class="ds-top-threads" data-range="weekly" data-num-items="4"></div>


          
  <div class="comments" id="comments">
    
      <div class="ds-thread" data-thread-key="2014/07/08/cas-server-config/"
           data-title="CAS 服务器端配置文件" data-url="http://blog.wglgg.cn/2014/07/08/cas-server-config/">
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.jpg"
               alt="ceylog" />
          <p class="site-author-name" itemprop="name">ceylog</p>
           
              <p class="site-description motion-element" itemprop="description">If you find a path with no obstacles, it probably doesn’t lead anywhere.</p>
          
        </div>
        <nav class="site-state motion-element">
        
          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">31</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">3</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">14</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/ceylog" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://twitter.com/ceylog" target="_blank" title="Twitter">
                  
                    <i class="fa fa-fw fa-twitter"></i>
                  
                  Twitter
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/ceylog" target="_blank" title="Weibo">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                  Weibo
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.facebook.com/ceylogs" target="_blank" title="Facebook">
                  
                    <i class="fa fa-fw fa-facebook"></i>
                  
                  Facebook
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#login-："><span class="nav-number">1.</span> <span class="nav-text">/login ：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#CAS数据流程"><span class="nav-number">2.</span> <span class="nav-text">CAS数据流程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#定义自己的AuthenticationHandler"><span class="nav-number">3.</span> <span class="nav-text">定义自己的AuthenticationHandler</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#定义自己的credentialsToPrincipalResolvers"><span class="nav-number">4.</span> <span class="nav-text">定义自己的credentialsToPrincipalResolvers</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2012 - 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ceylog</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"wglgg"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
    
    <script src="/lib/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
    <script src="/js/src/hook-duoshuo.js"></script>
  













  
  
  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
      search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body").append('<div class="popoverlay">').css('overflow', 'hidden');
      $('.popup').toggle();
    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';
      $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = $( "entry", xmlResponse ).map(function() {
            return {
              title: $( "title", this ).text(),
              content: $("content",this).text(),
              url: $( "url" , this).text()
            };
          }).get();
          var $input = document.getElementById(search_id);
          var $resultContent = document.getElementById(content_id);
          $input.addEventListener('input', function(){
            var matchcounts = 0;
            var str='<ul class=\"search-result-list\">';
            var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
            $resultContent.innerHTML = "";
            if (this.value.trim().length > 1) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var content_index = [];
                var data_title = data.title.trim().toLowerCase();
                var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                var data_url = decodeURIComponent(data.url);
                var index_title = -1;
                var index_content = -1;
                var first_occur = -1;
                // only match artiles with not empty titles and contents
                if(data_title != '') {
                  keywords.forEach(function(keyword, i) {
                    index_title = data_title.indexOf(keyword);
                    index_content = data_content.indexOf(keyword);
                    if( index_title >= 0 || index_content >= 0 ){
                      isMatch = true;
                      if (i == 0) {
                        first_occur = index_content;
                      }
                    }

                  });
                }
                // show search results
                if (isMatch) {
                  matchcounts += 1;
                  str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                  var content = data.content.trim().replace(/<[^>]+>/g,"");
                  if (first_occur >= 0) {
                    // cut out 100 characters
                    var start = first_occur - 20;
                    var end = first_occur + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if(start == 0){
                      end = 50;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    var match_content = content.substring(start, end);
                    // highlight all keywords
                    keywords.forEach(function(keyword){
                      var regS = new RegExp(keyword, "gi");
                      match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                    });

                    str += "<p class=\"search-result\">" + match_content +"...</p>"
                  }
                  str += "</li>";
                }
              })};
            str += "</ul>";
            if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
            if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
            $resultContent.innerHTML = str;
          });
          proceedsearch();
        }
      });}

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".popoverlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>


  

  

  

  


</body>
</html>
